<!DOCTYPE html>
<html lang="zh-CN" data-lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Artwork-5 Dialogue Test - ã€Šæ•°æ¯ç”Ÿé•¿ã€‹</title>
  <link rel="stylesheet" href="styles/components/dialogue-player.css">
  <style>
    body {
      margin: 0;
      padding: 40px 20px;
      background: #F9F8F6;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    h1 {
      text-align: center;
      color: #2d2d2d;
      margin-bottom: 10px;
    }
    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 20px;
      font-size: 0.95rem;
    }
    .test-info {
      background: white;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .test-info h2 {
      margin-top: 0;
      font-size: 1.2rem;
      color: #374151;
    }
    .test-info ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    .test-info li {
      margin: 8px 0;
      color: #4b5563;
    }
    .test-info code {
      background: #f3f4f6;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 0.9rem;
    }
    .stats {
      background: #f0f9ff;
      border-left: 4px solid #3b82f6;
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }
    .stats h3 {
      margin-top: 0;
      color: #1e40af;
      font-size: 1rem;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .stat-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .stat-label {
      color: #374151;
      font-size: 0.9rem;
    }
    .stat-value {
      color: #1e40af;
      font-weight: 600;
      font-size: 1.1rem;
    }
    #dialogue-container {
      margin-top: 30px;
    }
    .btn {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: background 0.2s;
    }
    .btn:hover {
      background: #2563eb;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>Phase 3.1: Artwork-5 Dialogue Conversion Test</h1>
    <div class="subtitle">ã€Šæ•°æ¯ç”Ÿé•¿ã€‹ Digital Breath Growth - Cheng Jiayu</div>

    <div class="test-info">
      <h2>ğŸ§ª æµ‹è¯•è¯´æ˜ Test Instructions</h2>

      <div class="stats">
        <h3>ğŸ“Š Dialogue Statistics</h3>
        <div class="stats-grid">
          <div class="stat-item">
            <span class="stat-label">Messages:</span>
            <span class="stat-value" id="msg-count">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Participants:</span>
            <span class="stat-value" id="participant-count">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Duration:</span>
            <span class="stat-value" id="duration">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Reply Chains:</span>
            <span class="stat-value" id="reply-count">-</span>
          </div>
        </div>
      </div>

      <p><strong>éªŒè¯è¦ç‚¹ Validation Checklist:</strong></p>
      <ul>
        <li>âœ… å¯¹è¯è‡ªåŠ¨æ’­æ”¾ (Auto-play starts)</li>
        <li>âœ… å›å¤é“¾æ­£ç¡® (Reply chains show <code>â†© å›å¤ [åå­—]</code>)</li>
        <li>âœ… å¼•æ–‡å¯ç‚¹å‡» (Quoted text clickable)</li>
        <li>âœ… çŸ¥è¯†åº“å¼•ç”¨æ˜¾ç¤º (References displayed)</li>
        <li>âœ… äº¤äº’ç±»å‹æ ‡ç­¾æ˜¾ç¤º (Interaction type labels visible)</li>
        <li>âœ… æ—¶é—´é—´éš”è‡ªç„¶ (4-7 second intervals)</li>
      </ul>

      <p><strong>äº¤äº’æµ‹è¯• Interaction Tests:</strong></p>
      <ul>
        <li><strong>æ¡Œé¢ç«¯:</strong> é¼ æ ‡æ‚¬åœå¼•ç”¨ â†’ æ˜¾ç¤ºç™½è‰²å·¥å…·æç¤º</li>
        <li><strong>ç§»åŠ¨ç«¯:</strong> ç‚¹å‡»å¼•ç”¨ â†’ æ‰“å¼€å…¨å±æ¨¡æ€æ¡†</li>
        <li><strong>è¯­è¨€åˆ‡æ¢:</strong> <button id="lang-toggle" class="btn">Switch to English</button></li>
      </ul>
    </div>

    <!-- Dialogue Player Container -->
    <div id="dialogue-container"></div>
  </div>

  <!-- Load Dependencies -->
  <script>
    // Load real VULCA_DATA with all 6 personas
    window.VULCA_DATA = {
      personas: [
        {
          id: "su-shi",
          nameZh: "è‹è½¼",
          nameEn: "Su Shi",
          color: "#B85C3C",
          period: "åŒ—å®‹ (1037-1101)"
        },
        {
          id: "guo-xi",
          nameZh: "éƒ­ç†™",
          nameEn: "Guo Xi",
          color: "#2D5F4F",
          period: "åŒ—å®‹ (1020-1090)"
        },
        {
          id: "john-ruskin",
          nameZh: "çº¦ç¿°Â·ç½—æ–¯é‡‘",
          nameEn: "John Ruskin",
          color: "#8B4513",
          period: "ç»´å¤šåˆ©äºšæ—¶ä»£ (1819-1900)"
        },
        {
          id: "mama-zola",
          nameZh: "ä½æ‹‰å¬·å¬·",
          nameEn: "Mama Zola",
          color: "#D97706",
          period: "è¥¿é Griot ä¼ ç»Ÿ"
        },
        {
          id: "professor-petrova",
          nameZh: "å½¼å¾—æ´›å¨ƒæ•™æˆ",
          nameEn: "Professor Petrova",
          color: "#7C3AED",
          period: "ä¿„å›½å½¢å¼ä¸»ä¹‰ (1910s-1930s)"
        },
        {
          id: "ai-ethics-reviewer",
          nameZh: "AIä¼¦ç†å®¡æŸ¥å‘˜",
          nameEn: "AI Ethics Reviewer",
          color: "#059669",
          period: "å½“ä»£ (2020s)"
        }
      ]
    };
  </script>
  <script src="js/components/dialogue-player.js"></script>
  <script type="module">
    // Import artwork-5 dialogue
    import { artwork5Dialogue } from './js/data/dialogues/artwork-5.js';

    console.log('âœ… Artwork-5 dialogue loaded:', artwork5Dialogue);

    // Update statistics
    document.getElementById('msg-count').textContent = artwork5Dialogue.messages.length;
    document.getElementById('participant-count').textContent = artwork5Dialogue.participants.length;

    const lastTimestamp = artwork5Dialogue.messages[artwork5Dialogue.messages.length - 1].timestamp;
    const durationSec = Math.round(lastTimestamp / 1000);
    document.getElementById('duration').textContent = `${durationSec}s (${(durationSec / 60).toFixed(1)}m)`;

    const replyCount = artwork5Dialogue.messages.filter(m => m.replyTo).length;
    document.getElementById('reply-count').textContent = replyCount;

    // Initialize DialoguePlayer
    const container = document.getElementById('dialogue-container');
    const player = new DialoguePlayer(artwork5Dialogue, container, {
      autoPlay: true,
      lang: 'zh'
    });

    console.log('âœ… DialoguePlayer initialized');

    // Language toggle
    document.getElementById('lang-toggle').addEventListener('click', () => {
      const html = document.documentElement;
      const currentLang = html.getAttribute('data-lang');
      const newLang = currentLang === 'zh' ? 'en' : 'zh';
      html.setAttribute('data-lang', newLang);

      // Update button text
      const btn = document.getElementById('lang-toggle');
      btn.textContent = newLang === 'zh' ? 'Switch to English' : 'åˆ‡æ¢åˆ°ä¸­æ–‡';

      // Trigger langchange event
      window.dispatchEvent(new Event('langchange'));

      console.log(`Language switched to: ${newLang}`);
    });
  </script>
</body>
</html>
