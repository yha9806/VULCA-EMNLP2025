# 调整后的实施策略

**更新时间**: 2025-11-05
**调整原因**: 30+ 作品数据需要等待，先基于现有作品搭建系统

---

## 🎯 核心调整

### 用户需求调整

**原计划**: 立即开始 30+ 作品的知识库构建和内容生成

**调整后**:
1. ✅ **基于现有 4 件作品**进行系统搭建
2. ✅ **预留接口和数据结构**，为未来 30+ 作品做好准备
3. ✅ **在开发分支**进行所有工作（不影响主网站）
4. ✅ **内容全部完成后**，再替换主网站的评论部分

---

## 📋 新的实施计划

### 阶段 1: 基础搭建阶段（基于现有 4 件作品）

**目标**: 建立完整的系统架构，使用现有数据验证可行性

#### Phase 1A: 知识库构建（精简版）
- **范围**: 仅为 **6 位评论家** 建立知识库（不针对具体作品）
- **深度**: 每位评论家 **50-70 条核心引用**（而非 100+）
- **时间**: 1 周（而非 2 周）

**任务清单**:
1. [ ] 创建知识库目录结构
2. [ ] 研究苏轼：诗词 + 艺术理论（20 条核心引用）
3. [ ] 研究郭熙：林泉高致 + 技法（20 条核心引用）
4. [ ] 研究 John Ruskin：Modern Painters + 工艺理论（20 条核心引用）
5. [ ] 研究 Mama Zola：Griot 传统 + 后殖民理论（20 条核心引用）
6. [ ] 研究 Professor Petrova：俄国形式主义 + 陌生化（20 条核心引用）
7. [ ] 研究 AI Ethics Reviewer：Kate Crawford + 算法正义（20 条核心引用）
8. [ ] 每位评论家提炼 5 个核心概念
9. [ ] 创建主题交叉引用文件（5 个主题）

**输出**: `knowledge-base/` 目录，约 300-420 条引用

---

#### Phase 1B: 数据结构扩展
- **范围**: 扩展现有数据结构，支持 5 章对话 + 图片同步
- **时间**: 3 天

**任务清单**:
1. [ ] 扩展 Artwork 数据结构（添加 `images` 数组）
2. [ ] 扩展 Message 数据结构（添加 `chapterNumber`, `highlightImage`, `imageAnnotation`, `references`）
3. [ ] 创建 Chapter 数据结构
4. [ ] 为现有 4 件作品添加 mock 图片数据（4-6 张/作品）
5. [ ] 更新现有对话，分配到 5 章（artwork-1 到 artwork-4）
6. [ ] 创建数据验证脚本
7. [ ] 测试数据结构扩展

**输出**: 扩展的数据结构，现有 4 件作品适配新格式

---

#### Phase 1C: 深度对话重构（现有 4 件作品）
- **范围**: 将现有的 6 个短线程（30-36 条消息）重构为 1 个深度对话（15-20 条）
- **时间**: 1 周

**任务清单**:
1. [ ] **Artwork-1**: 合并 6 个线程 → 1 个 18 条消息的深度对话
   - [ ] 分析现有 6 个线程的主题
   - [ ] 重组为 5 章结构
   - [ ] 使用知识库优化 3-5 条关键消息
   - [ ] 分配图片到章节
   - [ ] 添加 `references` 字段（至少 50% 消息）

2. [ ] **Artwork-2**: 同样流程（18 条消息）
3. [ ] **Artwork-3**: 同样流程（16 条消息）
4. [ ] **Artwork-4**: 同样流程（17 条消息）

**输出**: 4 件作品，每件 15-20 条消息，5 章结构，知识库引用

---

#### Phase 1D: 图片同步组件开发
- **范围**: 开发 ImageGallery 组件，实现图片与对话同步
- **时间**: 1 周

**任务清单**:
1. [ ] 创建 `js/components/image-gallery.js`
2. [ ] 实现图片切换逻辑（监听 `message-revealed` 事件）
3. [ ] 实现图片注释覆盖层
4. [ ] 实现缩略图导航
5. [ ] 实现移动端响应式布局
6. [ ] 集成到 DialoguePlayer
7. [ ] 测试图片同步功能

**输出**: ImageGallery 组件，完整图片同步功能

---

#### Phase 1E: 测试与优化
- **范围**: 全面测试 4 件作品的深度对话系统
- **时间**: 3 天

**任务清单**:
1. [ ] 功能测试（对话流、图片切换、章节导航）
2. [ ] 跨浏览器测试（Chrome, Firefox, Safari）
3. [ ] 移动端测试（iOS, Android）
4. [ ] 性能测试（加载时间、内存使用）
5. [ ] 可访问性测试（屏幕阅读器、键盘导航）
6. [ ] 修复发现的问题
7. [ ] 优化性能

**输出**: 稳定、可用的深度对话系统（4 件作品）

---

### 阶段 2: 接口预留与文档化

**目标**: 为未来 30+ 作品预留清晰的接口和扩展路径

#### Phase 2A: 内容生成模板
- **时间**: 2 天

**任务清单**:
1. [ ] 创建对话生成模板（基于 artwork-1 的成功模式）
2. [ ] 创建研究模板（artwork-research-template.md）
3. [ ] 创建章节生成提示模板（5 个章节）
4. [ ] 创建 Voice Validation Checklist
5. [ ] 文档化生成流程（step-by-step guide）

**输出**: 完整的内容生成工具包

---

#### Phase 2B: 扩展性文档
- **时间**: 1 天

**任务清单**:
1. [ ] 创建 `docs/adding-artwork-dialogues.md`
   - 如何添加新作品
   - 如何生成对话
   - 如何分配图片
   - 如何验证质量
2. [ ] 创建 `docs/knowledge-base-maintenance.md`
   - 如何添加新引用
   - 如何更新评论家概念
   - 如何维护版本
3. [ ] 更新 CLAUDE.md 和 SPEC.md

**输出**: 完整的扩展指南，任何人可独立添加新作品

---

### 阶段 3: 分支开发与集成

**目标**: 在开发分支完成所有工作，不影响主网站

#### Phase 3A: 创建开发分支
- **分支名称**: `feature/knowledge-base-dialogue-system`
- **基于**: 当前 master 分支

**Git 工作流**:
```bash
# 1. 创建并切换到开发分支
git checkout -b feature/knowledge-base-dialogue-system

# 2. 所有工作在此分支进行
# - 知识库构建
# - 数据结构扩展
# - 对话重构
# - 组件开发

# 3. 定期提交
git add .
git commit -m "feat(kb): Add knowledge base for 6 critics"
git commit -m "feat(data): Extend data structures for chapters"
git commit -m "feat(dialogue): Refactor artwork-1 to deep dialogue"
# ... etc

# 4. 完成后，合并回 master
git checkout master
git merge feature/knowledge-base-dialogue-system
git push origin master
```

---

#### Phase 3B: 内容完成验收标准

**只有满足以下所有条件，才能合并到 master**:

1. ✅ **知识库完整**
   - [ ] 6 位评论家各有 50-70 条引用
   - [ ] 每位评论家 5 个核心概念
   - [ ] 所有引用有完整的来源和上下文

2. ✅ **4 件作品重构完成**
   - [ ] 每件作品 15-20 条消息
   - [ ] 5 章结构清晰
   - [ ] 至少 50% 消息有知识库引用
   - [ ] 所有消息有图片分配

3. ✅ **图片系统工作正常**
   - [ ] 图片自动切换
   - [ ] 图片注释显示
   - [ ] 缩略图导航可用
   - [ ] 移动端响应式布局正常

4. ✅ **质量验证通过**
   - [ ] Voice authenticity ≥80%（4 件作品平均）
   - [ ] 无明显的技术错误或事实错误
   - [ ] 所有 6 位评论家有明显区分的声音

5. ✅ **文档完整**
   - [ ] 扩展指南完成
   - [ ] 生成模板完成
   - [ ] CLAUDE.md 和 SPEC.md 更新

6. ✅ **测试通过**
   - [ ] 跨浏览器测试通过
   - [ ] 移动端测试通过
   - [ ] 性能测试通过
   - [ ] 可访问性测试通过

---

### 阶段 4: 等待数据，预留接口

**当前状态**: 系统已完成，等待 30+ 作品数据

**预留的接口**:
1. ✅ **数据结构**: 已支持任意数量的作品
2. ✅ **知识库**: 评论家知识库独立于作品，可复用
3. ✅ **生成模板**: 提供了清晰的内容生成流程
4. ✅ **扩展文档**: 任何人可按文档添加新作品

**未来工作**（当有 30+ 作品数据时）:
1. 按照 `docs/adding-artwork-dialogues.md` 逐个添加作品
2. 为每件作品：
   - 填写研究模板
   - 生成 5 章对话（15-20 条消息）
   - 分配 7-8 张图片
   - 验证质量
3. 每完成 5 件作品，运行一次 QA review
4. 最终测试和部署

**预估时间**（未来）:
- 每件作品：3-4 小时（研究 + 生成 + 验证）
- 30 件作品：90-120 小时（分批进行）

---

## 📊 调整后的时间线

### 第 1-2 周：基础搭建（基于现有 4 件作品）

| 阶段 | 任务 | 时间 | 输出 |
|------|------|------|------|
| Phase 1A | 知识库构建（精简版） | 1 周 | 300-420 条引用，6 位评论家 |
| Phase 1B | 数据结构扩展 | 3 天 | 扩展的数据结构 |
| Phase 1C | 深度对话重构（4 件作品） | 1 周 | 4 件作品 × 15-20 条消息 |
| Phase 1D | 图片同步组件 | 1 周 | ImageGallery 组件 |
| Phase 1E | 测试与优化 | 3 天 | 稳定系统 |

**总计**: 约 3.5 周

### 第 3 周：接口预留与文档化

| 阶段 | 任务 | 时间 | 输出 |
|------|------|------|------|
| Phase 2A | 内容生成模板 | 2 天 | 生成工具包 |
| Phase 2B | 扩展性文档 | 1 天 | 扩展指南 |
| Phase 3B | 验收与合并 | 2 天 | 合并到 master |

**总计**: 约 1 周

### 总时间：4-5 周

**之后**: 等待 30+ 作品数据，预留接口已准备好

---

## 🎯 关键优势

### 调整后的优势 ✅

1. **风险降低**: 先用 4 件作品验证系统可行性，再扩展到 30+
2. **渐进式开发**: 不一次性投入 11 周，而是 4-5 周验证核心功能
3. **分支隔离**: 在开发分支工作，主网站不受影响
4. **接口清晰**: 预留好扩展路径，未来添加作品简单直接
5. **知识库复用**: 评论家知识库一次构建，无限复用

### 与原计划的对比

| 维度 | 原计划 | 调整后 | 变化 |
|------|--------|--------|------|
| **知识库深度** | 100+ 引用/人 | 50-70 引用/人 | -30% |
| **作品数量（初期）** | 30 件 | 4 件 | -87% |
| **时间投入（初期）** | 11 周 | 4-5 周 | -55% |
| **数据结构** | 完整扩展 | 完整扩展 | 相同 ✅ |
| **图片同步** | 完整实现 | 完整实现 | 相同 ✅ |
| **扩展性** | 支持 30+ | 支持 30+ | 相同 ✅ |

---

## 📝 修订后的 OpenSpec 提案

### 需要修改的部分

1. **Proposal.md**:
   - 更新"What Changes"：明确分阶段实施
   - 更新"How"：Phase 1 基于 4 件作品，Phase 2 等待数据

2. **Tasks.md**:
   - 重新组织为 2 个主要阶段：
     - Stage 1: 基础搭建（4-5 周）
     - Stage 2: 扩展到 30+（未来，等待数据）
   - 调整任务优先级和依赖关系

3. **Design.md**:
   - 添加"分阶段实施"架构决策
   - 解释为何先 4 件后 30+

---

## ✅ 下一步行动

**立即可以开始**:
1. 创建开发分支 `feature/knowledge-base-dialogue-system`
2. 开始 Phase 1A: 知识库构建（苏轼的 20 条核心引用）
3. 更新 OpenSpec 提案文档

**需要用户确认**:
- [ ] 这个调整后的策略是否符合你的预期？
- [ ] 4-5 周的时间线是否可接受？
- [ ] 是否立即开始，还是需要等待？
- [ ] 知识库深度（50-70 条引用/人）是否足够？

**准备好开始了吗？**

---

**文档生成时间**: 2025-11-05
**作者**: Claude (AI Assistant)
**状态**: ✅ 完成，等待用户确认开始
