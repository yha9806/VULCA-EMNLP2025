!function(){"use strict";function e(e){return e?e.images&&Array.isArray(e.images)&&e.images.length>0?(console.log(`[Image Compat] Using images array for ${e.id} (${e.images.length} images)`),e.images):e.imageUrl?(console.log(`[Image Compat] Converting legacy imageUrl for ${e.id}`),[{id:`${e.id}-legacy`,url:e.imageUrl,category:window.IMAGE_CATEGORIES?window.IMAGE_CATEGORIES.FINAL:"final",sequence:1,titleZh:e.titleZh||"未命名作品",titleEn:e.titleEn||"Untitled Artwork",caption:e.context||"",metadata:{year:e.year,artist:e.artist}}]):(console.warn(`[Image Compat] No images found for artwork ${e.id}`),[]):(console.warn("[Image Compat] getArtworkImages called with null/undefined artwork"),[])}window.ImageCompat={getArtworkImages:e,getPrimaryImage:function(a){const i=e(a);if(0===i.length)return null;if(a.primaryImageId){const e=i.find(e=>e.id===a.primaryImageId);if(e)return console.log(`[Image Compat] Using designated primary image ${a.primaryImageId} for ${a.id}`),e;console.warn(`[Image Compat] Primary image ${a.primaryImageId} not found for ${a.id}, falling back to first image`)}const t=[...i].sort((e,a)=>e.sequence-a.sequence);return console.log(`[Image Compat] Using first image as primary for ${a.id}`),t[0]},isMultiImageArtwork:function(e){return e&&e.images&&Array.isArray(e.images)&&e.images.length>1},getImageCount:function(a){return e(a).length}},console.log("[Image Compat] Utility initialized with functions:",Object.keys(window.ImageCompat))}();