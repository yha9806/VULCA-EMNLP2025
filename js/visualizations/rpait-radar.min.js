!function(){"use strict";let n=null,e=["su-shi","guo-xi","john-ruskin"],t="artwork-1";const o={dimensions:{zh:["代表性","哲学性","美学性","身份性","传统性"],en:["Representation","Philosophicality","Aesthetics","Identity","Tradition"]},ariaPrefix:{zh:"RPAIT雷达图显示",en:"RPAIT radar chart showing"},ariaUnit:{zh:"位评论家",en:"critics"}};function a(){return document.documentElement.getAttribute("data-lang")||"zh"}function r(n,e){return"en"===e&&n.nameEn||n.nameZh}function i(){const n=a();return{labels:o.dimensions[n],datasets:e.map(e=>{const o=window.VULCA_DATA.personas.find(n=>n.id===e);if(!o)return null;const a=window.VULCA_ANALYSIS.getPersonaArtworkRPAIT(e,t)||window.VULCA_ANALYSIS.getPersonaAverageRPAIT(e);return a?{label:r(o,n),data:[a.R,a.P,a.A,a.I,a.T],backgroundColor:(i=o.color,d=.2,`rgba(${parseInt(i.slice(1,3),16)}, ${parseInt(i.slice(3,5),16)}, ${parseInt(i.slice(5,7),16)}, ${d})`),borderColor:o.color,borderWidth:2,pointBackgroundColor:o.color,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:o.color,pointRadius:4,pointHoverRadius:6}:null;var i,d}).filter(Boolean)}}function d(){if(!n)return;const e=i();n.data=e,n.update("none"),s()}function s(){const n=document.getElementById("rpait-radar-chart");if(!n)return;const o=window.VULCA_DATA.personas.find(n=>n.id===e[0]);if(!o)return;const a=window.VULCA_ANALYSIS.getPersonaArtworkRPAIT(e[0],t)||window.VULCA_ANALYSIS.getPersonaAverageRPAIT(e[0]);if(a){const e=`RPAIT雷达图显示${o.nameZh}的分数：代表性 ${a.R}，哲学性 ${a.P}，美学性 ${a.A}，身份性 ${a.I}，传统性 ${a.T}`;n.setAttribute("aria-label",e)}}function c(n){const{artworkId:e}=n.detail;e&&(t=e,d())}function s(){const n=document.getElementById("rpait-radar-chart");if(!n)return;const t=a(),i=e.map(n=>{const e=window.VULCA_DATA.personas.find(e=>e.id===n);return e?r(e,t):n}).join("zh"===t?"、":", "),d=o.ariaPrefix[t],s=e.length,c=o.ariaUnit[t];n.setAttribute("aria-label",`${d} ${s} ${c}: ${i}`)}function l(){window.VULCA_DATA&&window.VULCA_ANALYSIS?window.Chart?(function(){const e=document.getElementById("rpait-radar-chart");if(!e)return void console.error("❌ Radar chart canvas not found");const t=e.getContext("2d"),o=i();n=new Chart(t,{type:"radar",data:o,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1.25,scales:{r:{min:0,max:10,ticks:{stepSize:2,font:{size:12},backdropColor:"transparent"},pointLabels:{font:{size:14,weight:"500"},color:"#2d2d2d"},grid:{color:"rgba(0, 0, 0, 0.1)"},angleLines:{color:"rgba(0, 0, 0, 0.1)"}}},plugins:{legend:{position:"bottom",labels:{font:{size:14},usePointStyle:!0,padding:15}},tooltip:{callbacks:{label:function(n){const e=["R","P","A","I","T"][n.dataIndex];return`${n.dataset.label}: ${e} = ${n.parsed.r}/10`}}}},animation:{duration:200,easing:"easeInOutQuad"}}}),console.log("✓ RPAIT radar chart initialized")}(),window.addEventListener("visualization:update",c),window.addEventListener("persona:selectionChanged",n=>{const{personas:t}=n.detail;console.log(`[Radar Chart] Selection changed to ${t.length} personas`,t),e=t,d(),s()}),document.addEventListener("langchange",n=>{console.log("[Radar Chart] Language changed, updating labels..."),d(),s()}),console.log("✓ Radar chart event listeners initialized")):console.error("❌ Chart.js not loaded"):console.error("❌ VULCA_DATA or VULCA_ANALYSIS not loaded")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l(),document.addEventListener("vulca-critiques-ready",()=>{console.log("[RPAITRadar] Critiques ready, re-initializing..."),l()}),window.RPAITRadar={selectPersona:function(n){const t=e.indexOf(n);t>-1?e.splice(t,1):e.push(n),d()},update:d}}();